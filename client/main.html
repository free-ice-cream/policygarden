<head>
  <title>Policy Garden</title>
  <script src="/cytoscape/cytoscape.min.js"></script>
  <script src="/cytoscape/cytoscape-cose-bilkent.js"></script>

</head>

<body>
  <h1>Policy Garden</h1>
  
  <section>
  <h2>Simulation Control</h2>
  {{#if simulationRunning}}
    <button class="simulation-toggle">simulation stop</button>
  {{else}}
    <label>speed</label> <input class="simulation-speed" value="{{simulationSpeed}}">
    <button class="simulation-toggle">simulation start</button>
    <button class="simulation-step">simulation step</button>
  {{/if}}
  </section>
  
  {{> policyGraph}}
    
  <section class="goals">
    <h2>Goals</h2>
    <div class="nodes">
      {{#each goals}}
        {{> node}}
      {{/each}}
    </div>
    <button class="create-goal">create goal</button>
  </section>

  <section class="policies">
    <h2>Policies</h2>
    <div class="nodes">
      {{#each policies}}
        {{> node}}
      {{/each}}
    </div>
    <button class="create-policy">create policy</button>
  </section>

  <section class="players">
    <h2>Players</h2>
    <div class="nodes">
      {{#each players}}
        {{> node}}
      {{/each}}
    </div>
    <button class="create-player">create player</button>
  </section>

</body>

<template name="node">
  <div class="node">
    <input name="title" value="{{title}}" placeholder="add a title">
    <input name="description" value={{description}} placeholder="add a description">
    <div class="data">
      <div class="data-row">
        <label>overflow level</label><input name="overflow" class="number" value="{{overflow}}">
      </div>
      <div class="data-row">
        <label>current level</label><input name="level" class="number" value="{{level}}">
      </div>
        {{#if policy}}
        <div class="data-row">
          <label>minimum level</label><input name="threshold" class="number" value="{{threshold}}">
        </div>
        {{/if}}
        {{#if player}}
        <div class="data-row">
          <label>replenishment</label><input name="replenish" class="number" value="{{replenish}}">
        </div>
        {{else}}
        <div class="data-row">
          <label>leak</label><input name="decay" class="number" value="{{decay}}">
        </div>
        {{/if}}
    </div>
    <div class="connections data">
      {{#if showConnections}}
        <h4>water flows to</h4>
      {{/if}}
      {{#each connections}}
        {{> connection}}
      {{/each}}
    </div>
    <button class="delete-node">delete</button>
  </div>
</template>

<template name="connection">
  <div class="data-row">
    <label>{{targetTitle}}</label><input name="bandwidth" value="{{bandwidth}}">
  </div>
</template>

<template name="policyGraph">
  <h2>Graph Overview</h2>
  <div id="cy"></div>
  <button class="refresh-graph">refresh</button>
</template>